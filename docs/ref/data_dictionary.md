# Study Data Dictionary
The data dictionary is a key component in a study's metadata and NCPI Whistler has the ability to extract data from the a data dictionary and pass that information on to whistle. In addition to being able to extract common components from data dictionaries and pass that information to whistle, NCPI Whistler has the ability to generate whistle code that is based on the data dictionary that is fully consistent with the [NCPI Metadata module](https://nih-ncpi.github.io/ncpi-fhir-ig/study_metadata.html). It is strongly recommended to provide study metadata alongside the study data inside FHIR and to properly link those resources together using the metadata terms according to the module description above. 

Whistle has a specific format that it expects for using the data-dictionary, however, each of the column names listed below can be mapped to whatever column names are used in the study's actual data-dictionary. Some columns are required (such as variable_name) and others highly recommended (like description) and some columns are completely optional, such as the min and max columns. 

## NCPI Whistler Data Dictionary Variable Names
The following describes the native data-dictionary variable names expected by NCPI Whistler. Users can provide alternate variable names inside the study configuration. 

### variable_name (required)
This variable is simply the variable name as it will be found in the respective data table's header. Variable names can contain whitespace, and varied case, but they should not include non-ascii characters. While whistler will drop all case to lower and replace any whitespace with an underscore when writing column names to whistle input files, it is strongly recommended that the data-dictionary's case and whitespace match the column header exactly so that the study metadata in FHIR is as close to the original format as possible. 

The variable_name is used as the "code" for the data-dictionary entries passed into Whistle during compilation. As a result, those codes will be incorporated into whistler generated whistle code. 

### description (required)
The *description* field must be present, but if empty, NCPI Whistler will copy the variable_name into the description property before constructing the whistle input. 

The *description* is a human readable description for the variable and will be used for the code's "display" property in CodeSystems generated by the NCPI Whistler autogenerated metadata whistle code. 

### data_type (required)
The data_type column should indicate what a variable's data_type is. The column **must** be present but can be empty (which will be interpreted to mean that the contents of that variable are strings). The following types are currently supported:

| Data Type | Alternate Spellings | Description |
| --- | --- | --- |
| string | (empty field), str | These cover any type of string variable including that that may only come from a specified list of values |
| integer | int | Integer values. |
| number | decimal | Numeric values that can include regular integer values, floating point values including those written using scientific notation understood by FHIR (eg 1.515E+2) |
| date | | Dates are currently not supported natively in NCPI Whistler except when generating whistle code for data-dictionaries. They are otherwise treated as strings. |

### enumerations (required)
The *enumerations* column must be present but can be empty. When present, it indicates that the contents of the variable should match one of the enumerations present in the string, including case and whitespace. The enumerations themselves should be separated by semicolon. 

### min
This only relates to integer and number fields and is used in metadata code generation to indicate what the proper range of the variable is. 

### max
This only relates to integer and number fields and is used in metadata code generation to indicate what the proper range of the variable is. 

### unit
This column indicates the unit associated with all values, such as 'cm' for height if all heights are recorded in centimeters. This information is used in the autogenerated whistle code for constructing data-dictionary resources. 

## Using Alternate Column Names
Because data-dictionaries will often have very different column names for the key properties, NCPI Whistler does permit the study configuration to provide alternate spellings for those columns. Under the data_dictionary property associated with the data table's entry, if the property, colnames is present, each subsequent property/value pair will indicate the expected column name as property and the real column name as the value. The following example shows how a data-dictionary with the header names: Variable Name, Description, Type and Values:

```
dataset:
  participant:
    filename: data/tables/studyname/participant.csv
    data_dictionary:
      filename: data/dd/participant-dd.csv
      colnames:
        variable_name: Variable Name
        description: Description
        data_type: Type
        enumerations: Values
    code_harmonization: harmony/data-harmony.csv
```

You don't have to provide entries for column names that match the expected column names, however, it may be clearer to include all columns. In the example above, "Variable Name" would actually be recogized as variable_name during processing, so it doesn't actually require inclusion in this particular configuration. Nor does description. However, it may be preferable to include them even if they are not required depending on the user's preferences.